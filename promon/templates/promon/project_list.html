{% extends "base.html" %}

{% block title %}Project List Report{% endblock title %}

{% block body %}
<div class="content project project-list">
    <div class="page-header">
        <h1>Project List <small>{{ projects|length }} total - <a href="{% url project_create %}?next={{ request.path }}" class="colorize success">add new</a></small></small></h1>
    </div>
    <div class="row">
        {% include "messages.html" %}
        <div class="span12">
            <form id="live-filter">
                <input id="project-search" type="text" autocomplete="off" />
                <span class="help-inline">Start Typing for Live Filtering</span>
            </form>
            <table id="project-list" class="table table-striped table-bordered table-condensed">
                <thead>
                <tr>
                    <th class="blue">#</th>
                    <th class="blue">Name</th>
                    <th class="blue">Owner</th>
                    <th class="blue">Tech</th>
                    <th class="blue">Age</th>
                    <th class="blue">Tasks</th>
                    <th class="blue">Hours</th>
                    <th class="blue">% Done</th>
                </tr>
                </thead>
                <tbody>
            {% for project in projects %}
                <tr class="project-row">
                    <td>{{ forloop.counter }}</td>
                    <td><a href="{% url project_detail project.pk %}">{{ project.name }}</a></td>
                    <td><a href="{% url user_detail project.owner.username %}">{{ project.owner.first_name }} {{ project.owner.last_name|slice:":1" }}.</a></td>
                    <td>{{ project.technology }}</td>
                    <td>{{ project.age }} days</td>
                    <td>{{ project.task_count }}</td>
                    <td>{{ project.task_hours }}</td>
                    <td>{{ project.completion_perc }} %</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock body %}

{% block js %}
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.tablesorter.min.js"></script>
<script type="text/javascript">
$(document).ready(function() { 
    $("#project-list").tablesorter({sortList: [[4,1]]});

    $('tr.project-row').show();
    $('form#live-filter').on('keyup', '#project-search', function(e) {
        var tmpVAL = $('#project-search').val().toLowerCase();
        $('.project-row').each(function() {
          var tmpHTML = $(this).html().toLowerCase();
          if (tmpHTML.indexOf(tmpVAL) >= 0) {
            $(this).fadeIn(150);
          } else if (tmpVAL.length < 1) {
            $(this).fadeIn(150);
          } else {
            $(this).fadeOut(150);
          }
        });
    });
});
</script>
{% endblock js %}